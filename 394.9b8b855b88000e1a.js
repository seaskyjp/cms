"use strict";(self.webpackChunkseaskyCMS=self.webpackChunkseaskyCMS||[]).push([[394],{394:(w,T,a)=>{a.r(T),a.d(T,{EditSolutionModule:()=>V});var x=a(4755),h=a(1195),v=a(5861),r=a(5030),y=a(9751),C=a(2340),n=a(2223),M=a(131),B=a(3272),J=a(8397),U=a(4259),D=a(2242),X=a(4247),E=a(4839),Q=a(6681),A=a(1929),g=a(4701),F=a(2701),L=a(3068),N=a(3355),S=a(8942);function O(e,l){if(1&e&&(n.ynx(0),n._UZ(1,"span",20),n.TgZ(2,"div",21),n._uU(3,"Upload"),n.qZA(),n.BQk()),2&e){const o=n.oxw();n.xp6(1),n.Q6J("nzType",o.loading?"loading":"plus")}}function R(e,l){if(1&e&&n._UZ(0,"img",22),2&e){const o=n.oxw();n.Q6J("src",o.avatarUrl,n.LSH)}}function Y(e,l){if(1&e&&(n.ynx(0),n._UZ(1,"span",20),n.TgZ(2,"div",21),n._uU(3,"Upload"),n.qZA(),n.BQk()),2&e){const o=n.oxw();n.xp6(1),n.Q6J("nzType",o.isImgLoading?"loading":"plus")}}function b(e,l){if(1&e&&n._UZ(0,"img",22),2&e){const o=n.oxw();n.Q6J("src",o.form.value.img,n.LSH)}}const I=function(){return[".png",".jpg"]},P=[{path:"",component:(()=>{class e{constructor(o,t,i,s,m){this.router=o,this.route=t,this.supabase=i,this.message=s,this.fb=m,this.id="",this.isLoading=!1,this.isImgLoading=!1,this.desc="",this.details="",this.loading=!1,this.transformFile=p=>new y.y(f=>{const u=new FileReader;u.readAsDataURL(p),this.uploadImages(p),u.onload=()=>{const z=document.createElement("canvas"),c=document.createElement("img");c.src=u.result,c.onload=()=>{const d=z.getContext("2d");d.drawImage(c,0,0),d.fillStyle="red",d.textBaseline="middle",d.fillText("Ant Design",20,20),z.toBlob(Z=>{f.next(Z),f.complete()})}}}),this.transformFileSec=p=>new y.y(f=>{const u=new FileReader;u.readAsDataURL(p),this.uploadImagesSec(p),u.onload=()=>{const z=document.createElement("canvas"),c=document.createElement("img");c.src=u.result,c.onload=()=>{const d=z.getContext("2d");d.drawImage(c,0,0),d.fillStyle="red",d.textBaseline="middle",d.fillText("Ant Design",20,20),z.toBlob(Z=>{f.next(Z),f.complete()})}}})}ngOnInit(){this.id=this.route.snapshot.params.id||"",this.form=this.fb.group({id:[null],created_at:[null],updated_at:[null],title:[null,[r.kI.required]],desc:[null],details:[null],img:[null,[r.kI.required]]}),this.id&&this.getDetails(+this.id)}getDetails(o){var t=this;return(0,v.Z)(function*(){t.isLoading=!0;const{data:i,error:s}=yield t.supabase.get("solutions",o,!0);s&&t.message.error(s.message),console.log(i),t.form.setValue({...i}),t.desc=i.desc,t.details=i.details,t.isLoading=!1})()}goBack(){this.router.navigateByUrl("solutions")}submitForm(){var o=this;return(0,v.Z)(function*(){if(o.form.valid){console.log(o.form.value),o.form.value.desc=o.desc,o.form.value.details=o.details;const{error:t}=yield o.supabase.upsert("solutions",o.form.value);t?o.message.error(t.message):(o.message.success("Success"),o.goBack())}else Object.values(o.form.controls).forEach(t=>{t.invalid&&(t.markAsDirty(),t.updateValueAndValidity({onlySelf:!0}))})})()}uploadImages(o){var t=this;return(0,v.Z)(function*(){const i=o.name.split(".").pop(),s=`${Math.random()}.${i}`;t.isImgLoading=!0;const{error:m}=yield t.supabase.uploadImages(s,o);m&&t.message.error(m.message),t.form.value.img=`${C.N.storageUrl}${s}`,t.form.setValue({...t.form.value}),t.isImgLoading=!1})()}uploadImagesSec(o){var t=this;return(0,v.Z)(function*(){const i=o.name.split(".").pop(),s=`${Math.random()}.${i}`;t.loading=!0;const{error:m}=yield t.supabase.uploadImages(s,o);m&&t.message.error(m.message),t.avatarUrl=`${C.N.storageUrl}${s}`,t.loading=!1})()}}return e.\u0275fac=function(o){return new(o||e)(n.Y36(h.F0),n.Y36(h.gz),n.Y36(M.T),n.Y36(B.dD),n.Y36(r.QS))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-edit-solution"]],decls:41,vars:33,consts:[[3,"nzSpinning"],[1,"header-wrap"],[1,"header-title"],["nz-button","","nzType","primary",1,"header-button",3,"click"],[1,"content-wrap"],["nz-form","",3,"formGroup","ngSubmit"],["nzRequired","","nzFor","title",3,"nzSm","nzXs"],[3,"nzSm","nzXs"],["nz-input","","formControlName","title","id","title"],["nzRequired","","nzFor","desc",3,"nzSm","nzXs"],["nzHeader","\u5c55\u958b\u3057\u307e\u3059","nzActive","false"],[2,"line-height","1.5 !important",3,"content","contentChange"],["nzRequired","","nzFor","details",3,"nzSm","nzXs"],["nzListType","picture-card",1,"uploader",3,"nzShowUploadList","nzAccept","nzTransformFile"],[4,"ngIf"],["style","width: 100%",3,"src",4,"ngIf"],["nzRequired","","nzFor","img",3,"nzSm","nzXs"],["nz-row","",1,"register-area"],[3,"nzSpan","nzOffset"],["nz-button","","nzType","primary",3,"nzLoading"],["nz-icon","",1,"upload-icon",3,"nzType"],[1,"ant-upload-text"],[2,"width","100%",3,"src"]],template:function(o,t){1&o&&(n.TgZ(0,"nz-spin",0)(1,"div",1),n._UZ(2,"div",2),n.TgZ(3,"button",3),n.NdJ("click",function(){return t.goBack()}),n._uU(4,"\u623b\u3063\u3066"),n.qZA()(),n._UZ(5,"nz-divider"),n.TgZ(6,"div",4)(7,"form",5),n.NdJ("ngSubmit",function(){return t.submitForm()}),n.TgZ(8,"nz-form-item")(9,"nz-form-label",6),n._uU(10,"Title"),n.qZA(),n.TgZ(11,"nz-form-control",7),n._UZ(12,"input",8),n.qZA()(),n.TgZ(13,"nz-form-item")(14,"nz-form-label",9),n._uU(15,"Description"),n.qZA(),n.TgZ(16,"nz-form-control",7)(17,"nz-collapse")(18,"nz-collapse-panel",10)(19,"app-content-editor",11),n.NdJ("contentChange",function(s){return t.desc=s}),n.qZA()()()()(),n.TgZ(20,"nz-form-item")(21,"nz-form-label",12),n._uU(22,"Details Content"),n.qZA(),n.TgZ(23,"nz-form-control")(24,"nz-collapse")(25,"nz-collapse-panel",10)(26,"nz-upload",13),n.YNc(27,O,4,1,"ng-container",14),n.YNc(28,R,1,1,"img",15),n.qZA(),n.TgZ(29,"app-content-editor",11),n.NdJ("contentChange",function(s){return t.details=s}),n.qZA()()()()(),n.TgZ(30,"nz-form-item")(31,"nz-form-label",16),n._uU(32,"Image"),n.qZA(),n.TgZ(33,"nz-form-control",7)(34,"nz-upload",13),n.YNc(35,Y,4,1,"ng-container",14),n.YNc(36,b,1,1,"img",15),n.qZA()()(),n.TgZ(37,"nz-form-item",17)(38,"nz-form-control",18)(39,"button",19),n._uU(40,"\u4fdd\u5b58"),n.qZA()()()()()()),2&o&&(n.Q6J("nzSpinning",t.isLoading),n.xp6(7),n.Q6J("formGroup",t.form),n.xp6(2),n.Q6J("nzSm",4)("nzXs",24),n.xp6(2),n.Q6J("nzSm",14)("nzXs",24),n.xp6(3),n.Q6J("nzSm",4)("nzXs",24),n.xp6(2),n.Q6J("nzSm",14)("nzXs",24),n.xp6(3),n.Q6J("content",t.desc),n.xp6(2),n.Q6J("nzSm",4)("nzXs",24),n.xp6(5),n.Q6J("nzShowUploadList",!1)("nzAccept",n.DdM(31,I))("nzTransformFile",t.transformFileSec),n.xp6(1),n.Q6J("ngIf",!t.avatarUrl),n.xp6(1),n.Q6J("ngIf",t.avatarUrl),n.xp6(1),n.Q6J("content",t.details),n.xp6(2),n.Q6J("nzSm",4)("nzXs",24),n.xp6(2),n.Q6J("nzSm",14)("nzXs",24),n.xp6(1),n.Q6J("nzShowUploadList",!1)("nzAccept",n.DdM(32,I))("nzTransformFile",t.transformFile),n.xp6(1),n.Q6J("ngIf",!t.form.value.img),n.xp6(1),n.Q6J("ngIf",t.form.value.img),n.xp6(2),n.Q6J("nzSpan",14)("nzOffset",6),n.xp6(1),n.Q6J("nzLoading",t.isLoading||t.isImgLoading))},dependencies:[x.O5,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,J.Zp,U.ix,D.w,X.dQ,E.g,Q.W,A.t3,A.SK,g.Lr,g.Nx,g.iK,g.Fd,F.Ls,L.FY,N.F,S.Zv,S.yH],styles:[".header-wrap[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{font-size:18px;display:inline-block}.header-wrap[_ngcontent-%COMP%]   .header-button[_ngcontent-%COMP%]{float:right}[_nghost-%COMP%]     .uploader>.ant-upload{width:128px;height:128px}"]}),e})()}];let $=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[h.Bz.forChild(P),h.Bz]}),e})();var j=a(3247),H=a(4233);let V=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[x.ez,$,r.UX,J.o7,U.sL,E.S,j.HQ,Q.j,g.U5,F.PV,L.cS,H.m,S.cD]}),e})()}}]);